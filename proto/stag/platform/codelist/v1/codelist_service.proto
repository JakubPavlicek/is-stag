syntax = "proto3";

package stag.platform.codelist.v1;

option java_package = "com.stag.platform.codelist.v1";
option java_outer_classname = "CodelistServiceProto";
option java_multiple_files = true;

service CodelistService {
  // Generic codelist lookup
  rpc GetCodelistValues(GetCodelistValuesRequest) returns (GetCodelistValuesResponse);

  // Use-case specific methods
  rpc GetPersonProfileData(GetPersonProfileDataRequest) returns (GetPersonProfileDataResponse);
  rpc GetPersonAddressData(GetPersonAddressDataRequest) returns (GetPersonAddressDataResponse);
  rpc GetPersonBankingData(GetPersonBankingDataRequest) returns (GetPersonBankingDataResponse);
  rpc GetPersonEducationData(GetPersonEducationDataRequest) returns (GetPersonEducationDataResponse);
}

message GetCodelistValuesRequest {
  repeated CodelistKey codelist_keys = 1;
  string language = 2;
}

message GetCodelistValuesResponse {
  repeated CodelistValue codelist_values = 1;
}

// Person Profile specific (only what's needed for GET /persons/{id})
message GetPersonProfileDataRequest {
  repeated CodelistKey codelist_keys = 1;  // titles, gender, marital status, citizenship qualifier
  optional int32 birth_country_id = 2;
  optional int32 citizenship_country_id = 3;
  string language = 4;
}

message GetPersonProfileDataResponse {
  repeated CodelistValue codelist_values = 1;
  optional CountryName birth_country_name = 2;
  optional CountryName citizenship_country_name = 3;
}

// Person Address specific (only what's needed for GET /persons/{id}/addresses)
message GetPersonAddressDataRequest {
  // Permanent residence
  optional int32 permanent_country_id = 1;
  optional int64 permanent_municipality_id = 2;
  optional int64 permanent_municipality_part_id = 3;
  optional int32 permanent_district_id = 4;

  // Temporary residence
  optional int32 temporary_country_id = 5;
  optional int64 temporary_municipality_id = 6;
  optional int64 temporary_municipality_part_id = 7;
  optional int32 temporary_district_id = 8;

  string language = 9;
}

message GetPersonAddressDataResponse {
  // Permanent residence
  optional CountryName permanent_country = 1;
  optional MunicipalityName permanent_municipality = 2;
  optional MunicipalityPartName permanent_municipality_part = 3;
  optional DistrictName permanent_district = 4;

  // Temporary residence
  optional CountryName temporary_country = 5;
  optional MunicipalityName temporary_municipality = 6;
  optional MunicipalityPartName temporary_municipality_part = 7;
  optional DistrictName temporary_district = 8;
}

// Banking specific request (only what's needed for GET /persons/{id}/banking)
message GetPersonBankingDataRequest {
  repeated CodelistKey codelist_keys = 1; // bank codes, currency codes
  string language = 2;
}

message GetPersonBankingDataResponse {
  repeated CodelistValue codelist_values = 1;
}

// Education specific request (only what's needed for GET /persons/{id}/education)
message GetPersonEducationDataRequest {
  optional int32 high_school_country_id = 1;
  repeated CodelistKey codelist_keys = 2; // education level, field of study codes
  string language = 3;
}

message GetPersonEducationDataResponse {
  repeated CodelistValue codelist_values = 1;
  optional CountryName high_school_country = 2;
}

// Generic messages
message CodelistKey {
  string domain = 1;
  string low_value = 2;
}

message CodelistValue {
  string domain = 1;
  string low_value = 2;
  string meaning = 3;
}

// Shared objects

message CountryName {
  string name = 1;
}

message MunicipalityName {
  string name = 2;
}

message MunicipalityPartName {
  string name = 2;
}

message DistrictName {
  string name = 2;
}
