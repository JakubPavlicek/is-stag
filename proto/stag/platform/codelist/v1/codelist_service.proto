syntax = "proto3";

package stag.platform.codelist.v1;

option java_package = "com.stag.platform.codelist.v1";
option java_outer_classname = "CodelistServiceProto";
option java_multiple_files = true;

service CodelistService {
  // Generic codelist lookup
  rpc GetCodelistValues(GetCodelistValuesRequest)
      returns (GetCodelistValuesResponse);

  // Use-case specific methods
  rpc GetPersonProfileData(GetPersonProfileDataRequest)
      returns (GetPersonProfileDataResponse);
  rpc GetPersonAddressData(GetPersonAddressDataRequest)
      returns (GetPersonAddressDataResponse);
  rpc GetPersonBankingData(GetPersonBankingDataRequest)
      returns (GetPersonBankingDataResponse);
  rpc GetPersonEducationData(GetPersonEducationDataRequest)
      returns (GetPersonEducationDataResponse);
}

message GetCodelistValuesRequest {
  repeated CodelistKey codelist_keys = 1;
  string language = 2;
}

message GetCodelistValuesResponse {
  repeated CodelistValue codelist_values = 1;
}

// Person Profile specific (only what's needed for GET /persons/{id})
message GetPersonProfileDataRequest {
  repeated CodelistKey codelist_keys = 1;
  optional int32 birth_country_id = 2;
  optional int32 citizenship_country_id = 3;
  string language = 4;
}

message GetPersonProfileDataResponse {
  repeated CodelistValue codelist_values = 1;
  optional string birth_country_name = 2;
  optional string citizenship_country_name = 3;
}

// Person Address specific (only what's needed for GET /persons/{id}/addresses)
message GetPersonAddressDataRequest {
  // Permanent residence
  optional int64 permanent_municipality_id = 1;
  optional int64 permanent_municipality_part_id = 2;
  optional int32 permanent_district_id = 3;
  optional int32 permanent_country_id = 4;

  // Temporary residence
  optional int64 temporary_municipality_id = 5;
  optional int64 temporary_municipality_part_id = 6;
  optional int32 temporary_district_id = 7;
  optional int32 temporary_country_id = 8;

  string language = 9;
}

message GetPersonAddressDataResponse {
  // Permanent residence
  optional string permanent_municipality_name = 1;
  optional string permanent_municipality_part_name = 2;
  optional string permanent_district_name = 3;
  optional string permanent_country_name = 4;

  // Temporary residence
  optional string temporary_municipality_name = 5;
  optional string temporary_municipality_part_name = 6;
  optional string temporary_district_name = 7;
  optional string temporary_country_name = 8;
}

// Banking specific request (for GET /persons/{id}/banking)
message GetPersonBankingDataRequest {
  repeated CodelistKey codelist_keys = 1; // bank codes, currency codes
  string language = 2;
}

message GetPersonBankingDataResponse {
  repeated CodelistValue codelist_values = 1;
}

// Education specific request (for GET /persons/{id}/education)
message GetPersonEducationDataRequest {
  optional int32 high_school_country_id = 1;
  repeated CodelistKey codelist_keys = 2;
  string language = 3;
}

message GetPersonEducationDataResponse {
  repeated CodelistValue codelist_values = 1;
  optional string high_school_country_name = 2;
}

// Generic messages
message CodelistKey {
  string domain = 1;
  string low_value = 2;
}

message CodelistValue {
  string domain = 1;
  string low_value = 2;
  string meaning = 3;
}
